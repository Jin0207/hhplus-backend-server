spring:
  application:
    name: hhplus
  profiles:
    active: local
  datasource:
    name: HangHaePlusDataSource
    type: com.zaxxer.hikari.HikariDataSource
    hikari:
      maximum-pool-size: 3
      connection-timeout: 10000
      max-lifetime: 60000
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    open-in-view: false
    generate-ddl: false
    show-sql: false
    hibernate:
      ddl-auto: none
    properties:
      hibernate.timezone.default_storage: NORMALIZE_UTC
      hibernate.jdbc.time_zone: UTC

---
spring.config.activate.on-profile: local

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/hhplus?characterEncoding=UTF-8&serverTimezone=UTC
    username: application
    password: application

  data:
    redis:
      host: localhost
      port: 6379
      database: 0

# ==========================================
# JWT 설정
# ==========================================
jwt:
  secret: test-secret-key-for-concurrency-test-min-256-bits-hhplus-backend-server
  expiration: 86400000  # 24시간

# ==========================================
# Outbox 패턴 설정
# ==========================================
outbox:
  # 메시지 배치 처리 크기
  batch-size: 100

  # 최대 재시도 횟수
  max-retry: 3

  # 처리 완료 메시지 보관 기간 (일)
  cleanup-days: 7

  # 스케줄러 설정
  schedule:
    # 메시지 발행 주기 (밀리초)
    publish-delay: 5000

    # 메시지 발행 초기 지연 (밀리초)
    publish-initial-delay: 10000

    # 메시지 정리 cron (매일 새벽 3시)
    cleanup-cron: "0 0 3 * * *"

    # Dead Letter Queue 체크 cron (매시간)
    dlq-check-cron: "0 0 * * * *"